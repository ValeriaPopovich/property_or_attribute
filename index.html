<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>–ü—Ä–∏–∑–Ω–∞–∫–∏ –∏ –°–≤–æ–π—Å—Ç–≤–∞ ‚Äî 2 —É—Ä–æ–≤–Ω—è</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet" />
  <style>
    :root {
      --bg: #fff6f8;
      --accent: #f59bbd;
      --accent-2: #ffc6d9;
      --accent-3: #ffe5ee;
      --text: #7a2f54;
      --card: #ffffff;
      --danger: #ff6b81;
    }
    * { box-sizing: border-box; }
    html, body { height: 100%; }
    body {
      margin: 0; padding: 40px 20px; display: flex; flex-direction: column; align-items: center;
      font-family: 'Poppins', sans-serif; background: var(--bg); color: var(--text);
    }
    h1 { color: var(--accent); font-size: clamp(1.4rem, 2.6vw, 2.6rem); margin-bottom: 16px; text-align: center; }

    .lives {
      display: flex; gap: 6px; margin-bottom: 24px; justify-content: center;
    }
    .life {
      font-size: 1.6rem;
    }
    .lost { opacity: .3; }

    .level { display: none; flex-direction: column; gap: 32px; width: 100%; max-width: 1100px; }
    .level.active { display: flex; }

    .game-area { display: flex; flex-direction: row; gap: 24px; align-items: flex-start; }
    .task-wrap { flex:1; display: grid; grid-template-columns: 1fr; gap: 14px; }
    .card {
      background: var(--card); padding: 16px 18px; border-radius: 18px;
      box-shadow: 0 8px 18px rgba(0,0,0,.06); cursor: grab; user-select: none; transition: transform .18s, box-shadow .18s;
      margin: 4px 0;
    }
    .card:active { cursor: grabbing; transform: scale(1.03); }
    .card.small { font-size: .95rem; }

    .columns { flex:1; display: flex; flex-direction: row; gap: 20px; justify-content: space-between; }
    .column {
      flex: 1;
      min-height: 300px; background: var(--accent-3); border-radius: 22px; padding: 24px 18px; text-align: center;
      box-shadow: inset 0 0 0 2px var(--accent-2), 0 8px 16px rgba(0,0,0,.04);
      transition: background .25s, box-shadow .25s;
    }
    .column h2 { margin: 12px 0 16px; color: var(--accent); font-size: 1.2rem; }
    .column.dragover { background: #ffd3e4; box-shadow: inset 0 0 0 2px var(--accent), 0 10px 20px rgba(0,0,0,.06); }

    .row { display:flex; gap:14px; align-items:center; justify-content:center; flex-wrap: wrap; margin-top: 20px; }

    .btn {
      background: var(--accent); color: #fff; border: none; border-radius: 28px; padding: 12px 22px;
      font-size: 1rem; cursor: pointer; transition: transform .15s, background .25s; box-shadow: 0 10px 16px rgba(245,155,189,.35);
    }
    .btn:hover { transform: translateY(-1px); background: #f07fac; }

    .toast { position: fixed; bottom: 18px; left: 50%; transform: translateX(-50%);
      background: var(--card); border-radius: 16px; padding: 10px 16px; box-shadow: 0 10px 24px rgba(0,0,0,.12);
      display: none; }
    .toast.show { display: inline-block; }

    .gameover {
      position: fixed; top:0; left:0; right:0; bottom:0; background: rgba(255,246,248,.95);
      display: none; flex-direction: column; justify-content: center; align-items: center;
      font-size: 1.4rem; font-weight:600; color: var(--danger); z-index: 10;
    }
    .gameover button { margin-top:20px; }

    footer { margin-top: auto; opacity: .7; font-size: .95rem; padding-top: 40px; text-align:center; }
    .subscribe-btn {
      margin-top: 10px; display:inline-block; background: var(--accent); color: #fff; text-decoration:none; padding: 10px 20px;
      border-radius: 24px; font-size: .95rem; box-shadow: 0 6px 14px rgba(245,155,189,.35); transition: background .25s;
    }
    .subscribe-btn:hover { background:#f07fac; }

    @media(max-width:768px){
      .game-area { flex-direction: column; }
      .columns { flex-direction: column; }
    }
  </style>
</head>
<body>
  <h1>–†–∞–∑–¥–µ–ª–∏: –ü—Ä–∏–∑–Ω–∞–∫ –∏–ª–∏ –°–≤–æ–π—Å—Ç–≤–æ?</h1>
  <div class="lives" id="lives"></div>

  <!-- –£—Ä–æ–≤–µ–Ω—å 1 -->
  <section class="level active" id="level1">
    <div class="game-area">
      <div class="task-wrap" id="tasks1"></div>
      <div class="columns">
        <div class="column" data-type="–ø—Ä–∏–∑–Ω–∞–∫"><h2>–ü—Ä–∏–∑–Ω–∞–∫</h2></div>
        <div class="column" data-type="—Å–≤–æ–π—Å—Ç–≤–æ"><h2>–°–≤–æ–π—Å—Ç–≤–æ</h2></div>
      </div>
    </div>
    <div class="row"><button class="btn" id="toLevel2" disabled>–î–∞–ª—å—à–µ ‚Üí —É—Ä–æ–≤–µ–Ω—å 2</button></div>
  </section>

  <!-- –£—Ä–æ–≤–µ–Ω—å 2 -->
  <section class="level" id="level2">
    <div class="game-area">
      <div class="task-wrap" id="tasks2"></div>
      <div class="columns">
        <div class="column" data-type="–ø—Ä–∏–∑–Ω–∞–∫"><h2>–ü—Ä–∏–∑–Ω–∞–∫</h2></div>
        <div class="column" data-type="—Å–≤–æ–π—Å—Ç–≤–æ"><h2>–°–≤–æ–π—Å—Ç–≤–æ</h2></div>
      </div>
    </div>
    <p id="finalMsg" style="font-weight:600; text-align:center; margin-top:20px; display:none;">üéâ –ë—Ä–∞–≤–æ! –í—Å–µ –∫–∞—Ä—Ç–æ—á–∫–∏ —Ä–∞–∑–ª–æ–∂–µ–Ω—ã –≤–µ—Ä–Ω–æ!</p>
  </section>

  <div class="toast" id="toast">–¢—ã —É–º–Ω–∏—á–∫–∞! –ü—Ä–æ–¥–æ–ª–∂–∞–π üíó</div>

  <div class="gameover" id="gameover">
    <p>–£–ø—Å üòî –ñ–∏–∑–Ω–∏ –∑–∞–∫–æ–Ω—á–∏–ª–∏—Å—å! –ü–æ–ø—Ä–æ–±—É–π —Å–Ω–æ–≤–∞!</p>
    <button class="btn" id="restartBtn">–ù–∞—á–∞—Ç—å –∑–∞–Ω–æ–≤–æ</button>
  </div>

  <footer>
    –ú–æ–π –∫–∞–Ω–∞–ª: <b>@lera_easy_math</b><br/>
    <a href="https://t.me/lera_easy_math" target="_blank" class="subscribe-btn">–ü–æ–¥–ø–∏—Å–∞—Ç—å—Å—è üíï</a>
  </footer>

  <script>
    // === –õ–æ–≥–∏–∫–∞ –∏–≥—Ä—ã ===
    let lives = 3;

    function renderLives(){
      const cont = document.getElementById('lives');
      cont.innerHTML = '';
      for(let i=0;i<3;i++){
        const heart = document.createElement('span');
        heart.className = i<lives ? 'life' : 'life lost';
        heart.textContent = '‚ù§';
        cont.appendChild(heart);
      }
    }
    renderLives();

    // === –ù–∞–±–æ—Ä—ã –∫–∞—Ä—Ç–æ—á–µ–∫ ===
    const tasksLevel1 = [
      { text: '–Ø–±–ª–æ–∫–æ –∫—Ä–∞—Å–Ω–æ–µ –∏ —Å–ª–∞–¥–∫–æ–µ', type: '—Å–≤–æ–π—Å—Ç–≤–æ' },
      { text: '–õ–∏–º–æ–Ω –∫–∏—Å–ª—ã–π', type: '—Å–≤–æ–π—Å—Ç–≤–æ' },
      { text: '–õ—ë–¥ —Ö–æ–ª–æ–¥–Ω—ã–π –∏ —Ç–≤—ë—Ä–¥—ã–π', type: '—Å–≤–æ–π—Å—Ç–≤–æ' },
      { text: '–ú—ë–¥ –≤—è–∑–∫–∏–π –∏ —Å–ª–∞–¥–∫–∏–π', type: '—Å–≤–æ–π—Å—Ç–≤–æ' },
      { text: '–°—Ç–µ–∫–ª–æ –ø—Ä–æ–∑—Ä–∞—á–Ω–æ–µ –∏ —Ö—Ä—É–ø–∫–æ–µ', type: '—Å–≤–æ–π—Å—Ç–≤–æ' },
      { text: '–ú–æ–ª–æ–∫–æ –±–µ–ª–æ–µ –∏ –∂–∏–¥–∫–æ–µ', type: '—Å–≤–æ–π—Å—Ç–≤–æ' },
      { text: '–ü–µ—Ä–µ—Ü –æ—Å—Ç—Ä—ã–π', type: '—Å–≤–æ–π—Å—Ç–≤–æ' },
      { text: '–û–≥—É—Ä–µ—Ü –∑–µ–ª—ë–Ω—ã–π –∏ —Å–æ—á–Ω—ã–π', type: '—Å–≤–æ–π—Å—Ç–≤–æ' },
      { text: '–•–ª–µ–± —Å–≤–µ–∂–∏–π –∏ –º—è–≥–∫–∏–π', type: '—Å–≤–æ–π—Å—Ç–≤–æ' },
      { text: '–ú–∞—Å–ª–æ —Å–ª–∏–≤–æ—á–Ω–æ–µ –∂–∏—Ä–Ω–æ–µ', type: '—Å–≤–æ–π—Å—Ç–≤–æ' },
      { text: '–ï—Å–ª–∏ –∂–∏–≤–æ—Ç–Ω–æ–µ —Å —à–µ—Ä—Å—Ç—å—é, –º—É—Ä–ª—ã—á–µ—Ç –∏ –¥–æ–º–∞—à–Ω–µ–µ ‚Äî —ç—Ç–æ –∫–æ—Ç', type: '–ø—Ä–∏–∑–Ω–∞–∫' },
      { text: '–ï—Å–ª–∏ –Ω–∞–ø–∏—Ç–æ–∫ —Å–ª–∞–¥–∫–∏–π —Å –ø—É–∑—ã—Ä—å–∫–∞–º–∏ –∏ –≤ –±—É—Ç—ã–ª–∫–µ ‚Äî —ç—Ç–æ –ª–∏–º–æ–Ω–∞–¥', type: '–ø—Ä–∏–∑–Ω–∞–∫' },
      { text: '–ï—Å–ª–∏ –∫—Ä—É–≥–ª–∞—è –ª–µ–ø—ë—à–∫–∞ —Å —Å–æ—É—Å–æ–º –∏ –Ω–∞—á–∏–Ω–∫–æ–π —Å–≤–µ—Ä—Ö—É ‚Äî —ç—Ç–æ –ø–∏—Ü—Ü–∞', type: '–ø—Ä–∏–∑–Ω–∞–∫' },
      { text: '–ï—Å–ª–∏ –æ–±—É–≤—å –Ω–∞ –≤—ã—Å–æ–∫–æ–π —Ç–æ–Ω–∫–æ–π —à–ø–∏–ª—å–∫–µ ‚Äî —ç—Ç–æ —Ç—É—Ñ–ª–∏ –Ω–∞ –∫–∞–±–ª—É–∫–µ', type: '–ø—Ä–∏–∑–Ω–∞–∫' },
      { text: '–ï—Å–ª–∏ –¥–ª–∏–Ω–Ω—ã–π –∑–µ–ª—ë–Ω—ã–π –æ–≤–æ—â —Å –ø—É–ø—ã—Ä—ã—à–∫–∞–º–∏ ‚Äî —ç—Ç–æ –æ–≥—É—Ä–µ—Ü', type: '–ø—Ä–∏–∑–Ω–∞–∫' },
      { text: '–ï—Å–ª–∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ —Å –±–æ–ª—å—à–∏–º —ç–∫—Ä–∞–Ω–æ–º –∏ —É–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –∫–∞—Å–∞–Ω–∏–µ–º ‚Äî —ç—Ç–æ –ø–ª–∞–Ω—à–µ—Ç', type: '–ø—Ä–∏–∑–Ω–∞–∫' },
      { text: '–ï—Å–ª–∏ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç —Å –¥–≤—É–º—è –∫–æ–ª—ë—Å–∞–º–∏ –∏ –ø–µ–¥–∞–ª—è–º–∏ ‚Äî —ç—Ç–æ –≤–µ–ª–æ—Å–∏–ø–µ–¥', type: '–ø—Ä–∏–∑–Ω–∞–∫' },
      { text: '–ï—Å–ª–∏ –Ω–∞–ø–∏—Ç–æ–∫ —á—ë—Ä–Ω—ã–π, –≥–æ—Ä—å–∫–∏–π –∏ –±–æ–¥—Ä–∏—Ç ‚Äî —ç—Ç–æ –∫–æ—Ñ–µ', type: '–ø—Ä–∏–∑–Ω–∞–∫' },
      { text: '–ï—Å–ª–∏ —è–≥–æ–¥—ã —Ä–∞—Å—Ç—É—Ç –∫–∏—Å—Ç—è–º–∏ –∏ –±—ã–≤–∞—é—Ç –∑–µ–ª—ë–Ω—ã–µ –∏–ª–∏ —Ñ–∏–æ–ª–µ—Ç–æ–≤—ã–µ ‚Äî —ç—Ç–æ –≤–∏–Ω–æ–≥—Ä–∞–¥', type: '–ø—Ä–∏–∑–Ω–∞–∫' },
      { text: '–ï—Å–ª–∏ —Å–ª–∞–¥–∫–∞—è –≥–∞–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –≤–æ–¥–∞ —Ç—ë–º–Ω–∞—è —Å –∫–∞—Ä–∞–º–µ–ª—å–Ω—ã–º –≤–∫—É—Å–æ–º ‚Äî —ç—Ç–æ –∫–æ–ª–∞', type: '–ø—Ä–∏–∑–Ω–∞–∫' },
    ];

    const tasksLevel2 = [
      { text: '–°—É–º–º–∞ —É–≥–ª–æ–≤ —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫–∞ —Ä–∞–≤–Ω–∞ 180¬∞', type: '—Å–≤–æ–π—Å—Ç–≤–æ' },
      { text: '–í —Ä–∞–≤–Ω–æ–±–µ–¥—Ä–µ–Ω–Ω–æ–º —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫–µ —É–≥–ª—ã –ø—Ä–∏ –æ—Å–Ω–æ–≤–∞–Ω–∏–∏ —Ä–∞–≤–Ω—ã', type: '—Å–≤–æ–π—Å—Ç–≤–æ' },
      { text: '–í —Ä–∞–≤–Ω–æ–±–µ–¥—Ä–µ–Ω–Ω–æ–º —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫–µ –º–µ–¥–∏–∞–Ω–∞ –∫ –æ—Å–Ω–æ–≤–∞–Ω–∏—é ‚Äî –∏ –±–∏—Å—Å–µ–∫—Ç—Ä–∏—Å–∞, –∏ –≤—ã—Å–æ—Ç–∞', type: '—Å–≤–æ–π—Å—Ç–≤–æ' },
      { text: '–í –ø–∞—Ä–∞–ª–ª–µ–ª–æ–≥—Ä–∞–º–º–µ –ø—Ä–æ—Ç–∏–≤–æ–ø–æ–ª–æ–∂–Ω—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã –∏ —Ä–∞–≤–Ω—ã', type: '—Å–≤–æ–π—Å—Ç–≤–æ' },
      { text: '–í –ø–∞—Ä–∞–ª–ª–µ–ª–æ–≥—Ä–∞–º–º–µ –¥–∏–∞–≥–æ–Ω–∞–ª–∏ –ø–µ—Ä–µ—Å–µ–∫–∞—é—Ç—Å—è –∏ –¥–µ–ª—è—Ç—Å—è –ø–æ–ø–æ–ª–∞–º', type: '—Å–≤–æ–π—Å—Ç–≤–æ' },
      { text: '–í —Ä–æ–º–±–µ –≤—Å–µ —Å—Ç–æ—Ä–æ–Ω—ã —Ä–∞–≤–Ω—ã', type: '—Å–≤–æ–π—Å—Ç–≤–æ' },
      { text: '–î–∏–∞–≥–æ–Ω–∞–ª–∏ —Ä–æ–º–±–∞ –≤–∑–∞–∏–º–Ω–æ –ø–µ—Ä–ø–µ–Ω–¥–∏–∫—É–ª—è—Ä–Ω—ã', type: '—Å–≤–æ–π—Å—Ç–≤–æ' },
      { text: '–í –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∏–∫–µ –≤—Å–µ —É–≥–ª—ã –ø—Ä—è–º—ã–µ', type: '—Å–≤–æ–π—Å—Ç–≤–æ' },
      { text: '–í —Ç—Ä–∞–ø–µ—Ü–∏–∏ –æ—Å–Ω–æ–≤–∞–Ω–∏—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã', type: '—Å–≤–æ–π—Å—Ç–≤–æ' },
      { text: '–°—Ä–µ–¥–Ω—è—è –ª–∏–Ω–∏—è —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫–∞ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞ –æ—Å–Ω–æ–≤–∞–Ω–∏—é –∏ —Ä–∞–≤–Ω–∞ –µ–≥–æ –ø–æ–ª–æ–≤–∏–Ω–µ', type: '—Å–≤–æ–π—Å—Ç–≤–æ' },
      { text: '–ï—Å–ª–∏ –≤ —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫–µ –¥–≤–∞ —É–≥–ª–∞ —Ä–∞–≤–Ω—ã ‚Äî –æ–Ω —Ä–∞–≤–Ω–æ–±–µ–¥—Ä–µ–Ω–Ω—ã–π', type: '–ø—Ä–∏–∑–Ω–∞–∫' },
      { text: '–ï—Å–ª–∏ –¥–∏–∞–≥–æ–Ω–∞–ª–∏ —á–µ—Ç—ã—Ä—ë—Ö—É–≥–æ–ª—å–Ω–∏–∫–∞ –ø–µ—Ä–µ—Å–µ–∫–∞—é—Ç—Å—è –∏ –¥–µ–ª—è—Ç—Å—è –ø–æ–ø–æ–ª–∞–º ‚Äî —ç—Ç–æ –ø–∞—Ä–∞–ª–ª–µ–ª–æ–≥—Ä–∞–º–º', type: '–ø—Ä–∏–∑–Ω–∞–∫' },
      { text: '–ï—Å–ª–∏ –æ–¥–Ω–∞ –ø–∞—Ä–∞ –ø—Ä–æ—Ç–∏–≤–æ–ø–æ–ª–æ–∂–Ω—ã—Ö —Å—Ç–æ—Ä–æ–Ω –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞ –∏ —Ä–∞–≤–Ω–∞ ‚Äî —ç—Ç–æ –ø–∞—Ä–∞–ª–ª–µ–ª–æ–≥—Ä–∞–º–º', type: '–ø—Ä–∏–∑–Ω–∞–∫' },
      { text: '–ï—Å–ª–∏ –≤ –ø–∞—Ä–∞–ª–ª–µ–ª–æ–≥—Ä–∞–º–º–µ –¥–∏–∞–≥–æ–Ω–∞–ª–∏ —Ä–∞–≤–Ω—ã ‚Äî —ç—Ç–æ –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∏–∫', type: '–ø—Ä–∏–∑–Ω–∞–∫' },
      { text: '–ï—Å–ª–∏ –≤—Å–µ —É–≥–ª—ã —á–µ—Ç—ã—Ä—ë—Ö—É–≥–æ–ª—å–Ω–∏–∫–∞ –ø—Ä—è–º—ã–µ ‚Äî —ç—Ç–æ –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∏–∫', type: '–ø—Ä–∏–∑–Ω–∞–∫' },
      { text: '–ï—Å–ª–∏ –≤—Å–µ —Å—Ç–æ—Ä–æ–Ω—ã —á–µ—Ç—ã—Ä—ë—Ö—É–≥–æ–ª—å–Ω–∏–∫–∞ —Ä–∞–≤–Ω—ã ‚Äî —ç—Ç–æ —Ä–æ–º–±', type: '–ø—Ä–∏–∑–Ω–∞–∫' },
      { text: '–ï—Å–ª–∏ –≤ –ø–∞—Ä–∞–ª–ª–µ–ª–æ–≥—Ä–∞–º–º–µ –¥–∏–∞–≥–æ–Ω–∞–ª–∏ –ø–µ—Ä–ø–µ–Ω–¥–∏–∫—É–ª—è—Ä–Ω—ã ‚Äî —ç—Ç–æ —Ä–æ–º–±', type: '–ø—Ä–∏–∑–Ω–∞–∫' },
      { text: '–ï—Å–ª–∏ –±–æ–∫–æ–≤—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã —Ç—Ä–∞–ø–µ—Ü–∏–∏ —Ä–∞–≤–Ω—ã ‚Äî —ç—Ç–æ —Ä–∞–≤–Ω–æ–±–µ–¥—Ä–µ–Ω–Ω–∞—è —Ç—Ä–∞–ø–µ—Ü–∏—è', type: '–ø—Ä–∏–∑–Ω–∞–∫' },
      { text: '–ï—Å–ª–∏ –æ–¥–∏–Ω —É–≥–æ–ª —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫–∞ –ø—Ä—è–º–æ–π ‚Äî —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫ –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω—ã–π', type: '–ø—Ä–∏–∑–Ω–∞–∫' },
      { text: '–ï—Å–ª–∏ –≤—Å–µ —Ç—Ä–∏ —Å—Ç–æ—Ä–æ–Ω—ã —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫–∞ —Ä–∞–≤–Ω—ã ‚Äî –æ–Ω —Ä–∞–≤–Ω–æ—Å—Ç–æ—Ä–æ–Ω–Ω–∏–π', type: '–ø—Ä–∏–∑–Ω–∞–∫' },
    ];

    // === –£—Ç–∏–ª–∏—Ç—ã ===
    const qs = (sel, ctx=document) => ctx.querySelector(sel);
    const qsa = (sel, ctx=document) => Array.from(ctx.querySelectorAll(sel));

    function shuffle(arr){
      for(let i=arr.length-1;i>0;i--){
        const j=Math.floor(Math.random()*(i+1));
        [arr[i],arr[j]]=[arr[j],arr[i]];
      }
      return arr;
    }

    // === –†–µ–Ω–¥–µ—Ä –∫–∞—Ä—Ç–æ—á–µ–∫ ===
    function renderTasks(tasks, containerId){
      const cont = qs('#'+containerId);
      cont.innerHTML = '';
      shuffle(tasks).forEach((t,idx)=>{
        const card = document.createElement('div');
        card.className = 'card small';
        card.textContent = t.text;
        card.draggable = true;
        card.dataset.type = t.type;
        card.id = containerId + '_card_' + idx;
        cont.appendChild(card);
      });
    }

    renderTasks(tasksLevel1, 'tasks1');
    renderTasks(tasksLevel2, 'tasks2');

    // === DnD ===
    function enableDnD(levelId){
      const level = qs('#'+levelId);
      const columns = qsa('.column', level);

      level.addEventListener('dragstart', (e)=>{
        const el = e.target.closest('.card');
        if(!el) return;
        e.dataTransfer.setData('text/plain', JSON.stringify({ id: el.id, type: el.dataset.type }));
      });

      columns.forEach(col=>{
        col.addEventListener('dragover', e=>{ e.preventDefault(); col.classList.add('dragover'); });
        col.addEventListener('dragleave', ()=> col.classList.remove('dragover'));
        col.addEventListener('drop', e=>{
          e.preventDefault();
          col.classList.remove('dragover');
          const data = JSON.parse(e.dataTransfer.getData('text/plain'));
          const dragEl = document.getElementById(data.id);
          if(!dragEl) return;
          if(col.dataset.type === data.type){
            dragEl.draggable = false;
            dragEl.style.cursor = 'default';
            col.appendChild(dragEl);
            showToast('–í–µ—Ä–Ω–æ! ‚úîÔ∏è');
            checkCompletion(levelId);
          } else {
            loseLife();
            dragEl.animate([
              {transform:'translateX(0)'},
              {transform:'translateX(-6px)'},
              {transform:'translateX(6px)'},
              {transform:'translateX(0)'}
            ],{duration:250});
          }
        });
      });
    }

    function showToast(msg){
      const t = qs('#toast');
      t.textContent = msg;
      t.classList.add('show');
      setTimeout(()=> t.classList.remove('show'), 1200);
    }

    function checkCompletion(levelId){
      const tasksWrap = qs('#'+ (levelId==='level1'?'tasks1':'tasks2'));
      const left = qsa('.card', tasksWrap).length;
      if(left===0){
        if(levelId==='level1'){
          qs('#toLevel2').disabled = false;
          showToast('–£—Ä–æ–≤–µ–Ω—å 1 –ø—Ä–æ–π–¥–µ–Ω!');
        } else {
          qs('#finalMsg').style.display = 'block';
          showToast('–ò–≥—Ä–∞ –ø—Ä–æ–π–¥–µ–Ω–∞!');
        }
      }
    }

    function loseLife(){
      lives--;
      if(lives<0) lives=0;
      renderLives();
      if(lives===0){
        const overlay = qs('#gameover');
        overlay.style.display = 'flex';
      }
    }

    enableDnD('level1');
    enableDnD('level2');

    // –°–±—Ä–æ—Å –∏–≥—Ä—ã –±–µ–∑ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏
    function resetGame(){
      lives = 3;
      renderLives();
      // –û—á–∏—Å—Ç–∏—Ç—å –∫–æ–ª–æ–Ω–∫–∏ –æ—Ç –∫–∞—Ä—Ç–æ—á–µ–∫
      qsa('.column').forEach(col=> qsa('.card', col).forEach(c=>c.remove()));
      // –ü–µ—Ä–µ—Ä–∏—Å–æ–≤–∞—Ç—å –∑–∞–¥–∞–Ω–∏—è
      renderTasks(tasksLevel1, 'tasks1');
      renderTasks(tasksLevel2, 'tasks2');
      // –°–ø—Ä—è—Ç–∞—Ç—å –æ–≤–µ—Ä–ª–µ–π –∏ —Ñ–∏–Ω–∞–ª
      qs('#gameover').style.display = 'none';
      const msg = qs('#finalMsg'); if(msg) msg.style.display='none';
      // –í–µ—Ä–Ω—É—Ç—å –Ω–∞ —É—Ä–æ–≤–µ–Ω—å 1
      qs('#level2').classList.remove('active');
      qs('#level1').classList.add('active');
      // –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –ø–µ—Ä–µ—Ö–æ–¥ –Ω–∞ 2 —É—Ä–æ–≤–µ–Ω—å –¥–æ —Ä–∞—Å–∫–ª–∞–¥–∫–∏
      const btn = qs('#toLevel2'); if(btn) btn.disabled = true;
    }
    qs('#restartBtn').addEventListener('click', resetGame);

    // –ü–µ—Ä–µ—Ö–æ–¥ –Ω–∞ 2 —É—Ä–æ–≤–µ–Ω—å —Å –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ–º, –µ—Å–ª–∏ –Ω–µ –≤—Å—ë —Ä–∞–∑–ª–æ–∂–µ–Ω–æ
    qs('#toLevel2').addEventListener('click', ()=>{
      const left = qsa('.card', qs('#tasks1')).length;
      if(left>0){
        const go = confirm('–¢—ã –Ω–µ –∑–∞–∫–æ–Ω—á–∏–ª —É—Ä–æ–≤–µ–Ω—å. –ü–µ—Ä–µ–π—Ç–∏ –Ω–∞ —Å–ª–µ–¥—É—é—â–∏–π? –ü—Ä–æ–≥—Ä–µ—Å—Å —É—Ä–æ–≤–Ω—è 1 –Ω–µ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—Å—è.');
        if(!go) return;
      }
      qs('#level1').classList.remove('active');
      qs('#level2').classList.add('active');
      window.scrollTo({top:0, behavior:'smooth'});
    });
  </script>
</body>
</html>
